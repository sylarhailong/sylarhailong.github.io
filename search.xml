<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[nginx配置详解]]></title>
    <url>%2F2017%2F08%2F17%2Fnginx%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[nginx是一个很强大的高性能Web和反向代理服务器，每次修改nginx配置都需要重新整理查找，因此总结了nginx配置信息，便于以后查阅 nginx.conf的例子12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697#nginx用户组user nobody nobody; #nginx工作进程数worker_processes 8; #nginx可以使用gdb进行调试,Crash的时候产生Core文件#working_directory表示Core文件存放的目录#worker_rlimit_core表示单个worker子进程所使用的Core文件大小的最大值working_directory /test/nginx;worker_rlimit_core 2G;#错误日志error_log logs/error.log error;pid sbin/nginx.pid;#指定进程可以打开的最大描述符：数目。#这个指令是指当一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（ulimit -n）与nginx进程数相除，但是nginx分配请求并不是那么均匀，所以最好与ulimit -n 的值保持一致。#现在在Linux 2.6内核下开启文件打开数为65535，worker_rlimit_nofile就相应应该填写65535。#这是因为nginx调度时分配请求到进程并不是那么的均衡，所以假如填写10240，总并发量达到3-4万时就有进程可能超过10240了，这时会返回502错误。worker_rlimit_nofile 51200;events&#123; use epoll; #使用epoll的I/O 模型，感兴趣的可以仔细了解下每个I/O模型的区别 不同操作系统下配置不同 worker_connections 51200; #每个工作进程的最大连接数量 理论上每台nginx服务器的最大连接数为：worker_processes*worker_connections&#125;http&#123; #nginx通过服务器端文件的后缀名来判断这个文件属于什么类型，再将该数据类型写入HTTP头部的Content-Type字段中，发送给客户端 include mime.types; #nginx默认返回的Content-Type字段 default_type application/octet-stream; #set_real_ip_from指令是告诉nginx，10.0.0.0是我们的反代服务器，不是真实的用户IP，可以包含多行这个配置 set_real_ip_from 10.0.0.0/8; set_real_ip_from 192.168.0.0/16; #当real_ip_recursive为off时，nginx会把real_ip_header指定的HTTP头中的最后一个IP当成真实IP #当real_ip_recursive为on时，nginx会把real_ip_header指定的HTTP头中的最后一个不是信任服务器的IP当成真实IP #当用户访问到我们的网站过程中经过多个路由转发，所以X-Forwarded-For应该是101.10.33.11, 192.168.0.10， #如果设置成off，取到的ip是192.168.0.10，如果设置成on，获得的ip为101.10.33.11，把取得的这个ip当成用户真实的ip real_ip_recursive on; #real_ip_header则是告诉nginx真正的用户IP是存在X-Forwarded-For请求头中 real_ip_header X-Forwarded-For; include xnet.conf; #日志格式 log_format main '$host $remote_addr [$time_local] "$request" ' '$status $body_bytes_sent "$http_referer" "$http_user_agent" ' '$ip2loc_code4 $cookie_SUID $request_time $cookie_SSUID ' '$http_x_forwarded_for $request_length $cookie_YYID '; log_format mini '$time_local $status $body_bytes_sent $request_time $upstream_cache_status $server_name $status $request_uri'; #访问日志打印地址 access_log "logs/$&#123;server_name&#125;_access_log" main; access_log logs/status_log mini; server_names_hash_bucket_size 128; client_header_buffer_size 32k; large_client_header_buffers 4 32k; client_max_body_size 20m; sendfile on; tcp_nopush on; tcp_nodelay on; send_timeout 300; proxy_connect_timeout 2; proxy_read_timeout 5; hmux_temp_path /dev/shm/nginx/hmux_temp/; hmux_buffers 4 16k; hmux_connect_timeout 2s; hmux_read_timeout 7s; hmux_send_timeout 6s; hmux_buffer_size 16k; hmux_flush always; req_status_zone server_name $server_name 256k; req_status_zone host $host 512k; req_status server_name host ; index index.html index.htm index.shtml; gzip_min_length 1000; gzip_comp_level 6; gzip_types text/plain text/xml application/x-javascript text/css application/xml; server_tokens off; include vhosts/*.conf;&#125;]]></content>
      <categories>
        <category>nginx</category>
      </categories>
      <tags>
        <tag>nginx.conf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[windows环境nodejs版本管理]]></title>
    <url>%2F2017%2F08%2F12%2Fwindow%E4%B8%8Bnodejs%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%2F</url>
    <content type="text"><![CDATA[由于业务需要使用nodejs，由于nodejs版本更新频繁，为方便使用通过安装nodejs版本管理器来解决这个问题，实验了两种方案，踩过一点小坑，记录一下 nvmw方案nvmw方案是cnode社区上给出的nodejs版本管理方案，尝试按照提示步骤进行，期间遇到了几个问题1nvmw install v6.11.2 提示“没有文件扩展”.js”的脚本引擎”这样的错误,原因是因为JS扩展名的文件被其他软件关联了，需要取消关联。采用的解决方案是：在运行中输入“regedit”进入注册表，把[HKEY_CLASSES_ROOT.js]项下的那个默认值改成”JSFile”就可以正常运行JS 文件了。解决了这个问题之后重新执行命令，又出现新的错误cscript不是内部或外部命令,未找到合适的解决方案，因此寻找新的方案。有成功的例子详见这篇文章 nvm-windows方案此方案比较简单，按照说明安装软件即可，顺利达到目的中间过程中踩了一个坑，在nvm use的命令的时候失效，原因是软件我安装在programe file下了，路径中存在空格，重新安装软件在全英文路径下，安装成功。建议安装路径不要又空格和中文。]]></content>
      <categories>
        <category>nodejs</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
      </tags>
  </entry>
</search>
